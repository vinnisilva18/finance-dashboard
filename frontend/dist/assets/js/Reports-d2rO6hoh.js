import{r as _,c as N,o as z,a as l,e,b as v,f as $,I as O,E as V,A as a,t as n,n as q,h as C,F,B as P,p as i}from"./vendor-kE9Pwckw.js";import{l as A}from"./localStorageService-Bm_UUCrj.js";import{a as E,f as h}from"./formatters-B8MMj10x.js";import{_ as U}from"./index-CZQAM9fZ.js";import"./utils-B9ygI19o.js";const Y=()=>{const k=_(!1),p=_(null),d=_({...{totalIncome:0,totalExpenses:0,netSavings:0,savingsRate:0,incomeChange:0,expenseChange:0,savingsChange:0,budgetStatus:"under",incomeSources:[],expenseCategories:[],budgetComparison:[],topTransactions:[],goals:[],goalsProgress:{completed:0,total:0,percentage:0}}});return{loading:k,error:p,reportData:d,generateReport:S=>{k.value=!0,p.value=null;try{const r=A.getData("transactions")||[],y=A.getData("categories")||[],m=A.getData("goals")||[],b=r,f=b.filter(o=>o.type==="income").reduce((o,c)=>o+c.amount,0),R=b.filter(o=>o.type==="expense").reduce((o,c)=>o+c.amount,0),w=f+R,T=f>0?w/f:0,B=y.filter(o=>o.type==="expense").map(o=>{const c=b.filter(g=>g.type==="expense"&&g.category===o.name).reduce((g,M)=>g+M.amount,0);return{name:o.name,amount:Math.abs(c),percentage:R!==0?(Math.abs(c)/Math.abs(R)*100).toFixed(1):0,color:o.color}}).filter(o=>o.amount>0).sort((o,c)=>c.amount-o.amount),I=[...b].sort((o,c)=>Math.abs(c.amount)-Math.abs(o.amount)).slice(0,5).map(o=>{const c=y.find(g=>g.name===o.category);return{...o,categoryColor:c?c.color:"#808080"}}),u=m.filter(o=>o.currentAmount>=o.targetAmount).length,t={completed:u,total:m.length,percentage:m.length>0?u/m.length*100:0},s=m.map(o=>{const c=o._id||o.id,g=o.title||o.name,M=o.currentAmount??o.current??0,L=o.targetAmount??o.target??0;return{id:c,name:g,current:M,target:L,progress:L>0?(M/L*100).toFixed(0):0,deadline:o.deadline,color:o.color}});d.value={totalIncome:f,totalExpenses:Math.abs(R),netSavings:w,savingsRate:T,incomeChange:0,expenseChange:0,savingsChange:0,budgetStatus:"under",incomeSources:[],expenseCategories:B,budgetComparison:[],topTransactions:I,goals:s,goalsProgress:t}}catch(r){p.value="Failed to generate report",console.error(r)}finally{k.value=!1}}}},G={class:"reports"},j={class:"header"},H={class:"header-actions"},J={key:0,class:"custom-range card"},K={class:"range-selector"},Q={class:"date-input"},W={class:"date-input"},X={key:1,class:"report-summary"},Z={class:"summary-card"},ee={class:"amount positive"},te={class:"summary-card"},se={class:"amount negative"},oe={class:"summary-card"},ae={class:"summary-card"},ne={class:"amount"},re={key:2,class:"loading-state"},le={key:3,class:"report-sections"},ie={class:"section-card card"},ce={class:"section-header"},de={class:"section-period"},ue={class:"income-breakdown"},pe={key:0,class:"empty-data"},me={class:"source-info"},ge={class:"source-name"},ve={class:"source-amount"},he={class:"source-bar"},_e={class:"source-percentage"},ye={class:"section-card card"},be={class:"section-header"},fe={class:"section-period"},Re={class:"expense-categories"},Ce={key:0,class:"empty-data"},ke={class:"category-info"},xe={class:"category-name"},De={class:"category-stats"},Se={class:"category-amount"},we={class:"category-percentage"},Me={class:"category-progress"},Fe={class:"progress-bar"},Pe={class:"section-card card"},Te={class:"section-header"},Be={class:"transaction-count"},Ie={class:"transactions-list"},Le={key:0,class:"empty-data"},$e={key:1},Ae={class:"section-card card"},Ee={class:"section-header"},Ne={class:"goals-summary"},Ve={class:"goals-progress"},qe={key:0,class:"empty-data"},ze={class:"goal-header"},Oe={class:"goal-name"},Ue={class:"goal-percentage"},Ye={class:"progress-bar"},Ge={class:"goal-details"},je={class:"goal-deadline"},He={key:4,class:"error-state"},Je={__name:"Reports",setup(k){const p=_("monthly"),x=_(!1);_("income");const d=_({start:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),{loading:D,error:S,reportData:r,generateReport:y}=Y(),m=N(()=>{const u=new Date;switch(p.value){case"monthly":return u.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});case"quarterly":return`T${Math.floor(u.getMonth()/3)+1} ${u.getFullYear()}`;case"yearly":return u.getFullYear().toString();case"custom":return`${E(d.value.start)} - ${E(d.value.end)}`;default:return"Per√≠odo Atual"}}),b=N(()=>{const u=r.value.savingsRate||0;return{background:`conic-gradient(#4CAF50 0% ${u*100}%, #f0f0f0 ${u*100}% 100%)`}});z(()=>{y(p.value)});const f=()=>{p.value==="custom"?x.value=!0:(x.value=!1,y(p.value))},R=()=>{y({start:d.value.start,end:d.value.end})},w=()=>{alert("Funcionalidade de exportar em desenvolvimento.")},T=()=>{window.print()},B=()=>{alert("Funcionalidade de salvar em desenvolvimento.")},I=()=>{navigator.share?navigator.share({title:`Relat√≥rio Financeiro - ${m.value}`,text:`Confira meu relat√≥rio financeiro para ${m.value}`,url:window.location.href}):alert("API de compartilhamento n√£o suportada no seu navegador.")};return(u,t)=>(i(),l("div",G,[e("div",j,[t[4]||(t[4]=e("h1",null,"Relat√≥rios Financeiros",-1)),e("div",H,[$(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),onChange:f,class:"period-select"},[...t[3]||(t[3]=[e("option",{value:"monthly"},"Relat√≥rio Mensal",-1),e("option",{value:"quarterly"},"Relat√≥rio Trimestral",-1),e("option",{value:"yearly"},"Relat√≥rio Anual",-1),e("option",{value:"custom"},"Per√≠odo Personalizado",-1)])],544),[[O,p.value]]),e("button",{onClick:w,class:"btn btn-primary"}," üìä Exportar Relat√≥rio ")])]),x.value?(i(),l("div",J,[t[7]||(t[7]=e("h3",null,"Intervalo de Datas Personalizado",-1)),e("div",K,[e("div",Q,[t[5]||(t[5]=e("label",null,"De",-1)),$(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>d.value.start=s),type:"date",class:"form-control"},null,512),[[V,d.value.start]])]),e("div",W,[t[6]||(t[6]=e("label",null,"Para",-1)),$(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value.end=s),type:"date",class:"form-control"},null,512),[[V,d.value.end]])]),e("button",{onClick:R,class:"btn btn-primary"}," Aplicar ")])])):v("",!0),a(D)?v("",!0):(i(),l("div",X,[e("div",Z,[t[8]||(t[8]=e("h3",null,"Receita Total",-1)),e("p",ee,n(a(h)(a(r).totalIncome,"BRL")),1)]),e("div",te,[t[9]||(t[9]=e("h3",null,"Despesa Total",-1)),e("p",se,n(a(h)(a(r).totalExpenses,"BRL")),1)]),e("div",oe,[t[10]||(t[10]=e("h3",null,"Economia L√≠quida",-1)),e("p",{class:q(["amount",a(r).netSavings>=0?"positive":"negative"])},n(a(h)(a(r).netSavings,"BRL")),3)]),e("div",ae,[t[11]||(t[11]=e("h3",null,"Taxa de Poupan√ßa",-1)),e("p",ne,n((a(r).savingsRate*100).toFixed(1))+"%",1),e("div",{class:"progress-circle",style:C(b.value)},[e("span",null,n(Math.round(a(r).savingsRate*100))+"%",1)],4)])])),a(D)?(i(),l("div",re,[...t[12]||(t[12]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Gerando relat√≥rio...",-1)])])):v("",!0),!a(D)&&!a(S)?(i(),l("div",le,[e("div",ie,[e("div",ce,[t[13]||(t[13]=e("h3",null,"Detalhamento de Receitas",-1)),e("div",de,n(m.value),1)]),e("div",ue,[a(r).incomeSources.length===0?(i(),l("div",pe," Nenhuma receita encontrada para este per√≠odo. ")):v("",!0),(i(!0),l(F,null,P(a(r).incomeSources,s=>(i(),l("div",{key:s.name,class:"source-item"},[e("div",me,[e("div",ge,n(s.name),1),e("div",ve,n(a(h)(s.amount,"BRL")),1)]),e("div",he,[e("div",{class:"bar-fill",style:C({width:`${s.amount/a(r).totalIncome*100}%`,backgroundColor:s.color})},null,4)]),e("div",_e,n((s.amount/a(r).totalIncome*100).toFixed(1))+"% ",1)]))),128))])]),e("div",ye,[e("div",be,[t[14]||(t[14]=e("h3",null,"Categorias de Despesas",-1)),e("div",fe,n(m.value),1)]),e("div",Re,[a(r).expenseCategories.length===0?(i(),l("div",Ce," Nenhuma despesa encontrada para este per√≠odo. ")):v("",!0),(i(!0),l(F,null,P(a(r).expenseCategories,s=>(i(),l("div",{key:s.name,class:"category-item"},[e("div",{class:"category-color",style:C({backgroundColor:s.color})},null,4),e("div",ke,[e("div",xe,n(s.name),1),e("div",De,[e("span",Se,n(a(h)(s.amount,"BRL")),1),e("span",we,n(s.percentage)+"%",1)])]),e("div",Me,[e("div",Fe,[e("div",{class:"progress-fill",style:C({width:`${s.percentage}%`,backgroundColor:s.color})},null,4)])])]))),128))])]),e("div",Pe,[e("div",Te,[t[15]||(t[15]=e("h3",null,"Maiores Transa√ß√µes",-1)),e("div",Be,n(a(r).topTransactions.length)+" maiores",1)]),e("div",Ie,[a(r).topTransactions.length===0?(i(),l("div",Le," Nenhuma transa√ß√£o encontrada para este per√≠odo. ")):(i(),l("table",$e,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",null,"Data"),e("th",null,"Descri√ß√£o"),e("th",null,"Categoria"),e("th",null,"Valor")])],-1)),e("tbody",null,[(i(!0),l(F,null,P(a(r).topTransactions,s=>(i(),l("tr",{key:s.id},[e("td",null,n(a(E)(s.date)),1),e("td",null,n(s.description),1),e("td",null,[e("span",{class:"category-tag",style:C({backgroundColor:s.categoryColor})},n(s.category),5)]),e("td",{class:q(s.amount>=0?"positive":"negative")},n(a(h)(s.amount,"BRL")),3)]))),128))])]))])]),e("div",Ae,[e("div",Ee,[t[17]||(t[17]=e("h3",null,"Progresso das Metas",-1)),e("div",Ne,n(a(r).goalsProgress.completed)+"/"+n(a(r).goalsProgress.total)+" completas ",1)]),e("div",Ve,[a(r).goals.length===0?(i(),l("div",qe," Nenhuma meta encontrada. ")):v("",!0),(i(!0),l(F,null,P(a(r).goals,s=>(i(),l("div",{key:s.id,class:"goal-item"},[e("div",ze,[e("span",Oe,n(s.name),1),e("span",Ue,n(s.progress)+"%",1)]),e("div",Ye,[e("div",{class:"progress-fill",style:C({width:`${s.progress}%`,backgroundColor:s.color})},null,4)]),e("div",Ge,[e("span",null,n(a(h)(s.current,"BRL"))+" / "+n(a(h)(s.target,"BRL")),1),e("span",je,n(s.deadline),1)])]))),128))])])])):v("",!0),a(S)?(i(),l("div",He,[t[18]||(t[18]=e("h3",null,"Ocorreu um erro ao gerar o relat√≥rio.",-1)),e("p",null,n(a(S)),1)])):v("",!0),e("div",{class:"report-actions"},[e("button",{onClick:T,class:"btn btn-primary"}," üñ®Ô∏è Imprimir Relat√≥rio "),e("button",{onClick:B,class:"btn btn-secondary"}," üíæ Salvar Relat√≥rio "),e("button",{onClick:I,class:"btn"}," üì§ Compartilhar ")])]))}},et=U(Je,[["__scopeId","data-v-8b0e68d9"]]);export{et as default};
