import{r as M,C as W,o as X,a as r,e as t,b as p,t as a,A as i,h as y,f as c,E as f,I as w,D as Y,F as k,B as g,l as Z,n as S,p as l}from"./vendor-kE9Pwckw.js";import{u as tt}from"./useGoals-CS3k8cK0.js";import{f as v,a as E}from"./formatters-B8MMj10x.js";import{u as et}from"./useCurrencies-CIa9VWEX.js";import{u as st}from"./useCategories-Cm3JPFZw.js";import{_ as ot}from"./index-CZQAM9fZ.js";import"./localStorageService-Bm_UUCrj.js";import"./utils-B9ygI19o.js";const nt={class:"goals"},at={class:"header"},it={class:"goals-summary"},rt={class:"summary-card"},lt={class:"amount"},dt={class:"summary-card"},ut={class:"amount"},ct={class:"summary-card"},mt={class:"progress-display"},pt={class:"amount"},vt={class:"progress-bar"},_t={class:"summary-card"},ft={class:"amount"},yt={key:0,class:"goal-form card"},bt={class:"form-row"},ht={class:"form-group"},Ct={class:"form-group"},At={class:"form-row"},Mt={class:"form-group"},wt={class:"form-group"},kt={class:"form-row"},gt={class:"form-group"},St={class:"form-group"},Dt={class:"form-row"},xt={class:"form-group"},Vt=["value"],Tt={class:"form-group"},Gt={class:"color-picker"},Nt={class:"form-group"},Et={class:"form-actions"},Ft=["disabled"],Rt={key:1,class:"loading"},Ut={key:2,class:"error"},$t={class:"tabs"},It={key:3,class:"goals-grid"},Pt={class:"goal-header"},qt={class:"goal-info"},Ot={class:"goal-category"},zt={class:"goal-actions"},Bt=["onClick"],Lt=["onClick"],jt={class:"goal-progress"},Ht={class:"progress-info"},Jt={class:"progress-text"},Kt={class:"progress-percentage"},Qt={class:"progress-bar"},Wt={class:"goal-details"},Xt={class:"detail-row"},Yt={class:"value"},Zt={class:"detail-row"},te={class:"value"},ee={class:"detail-row"},se={class:"value"},oe={class:"detail-row"},ne={class:"value"},ae={class:"detail-row"},ie={class:"value"},re={key:0,class:"goal-description"},le={key:4,class:"completed-goals"},de={class:"goal-header"},ue={class:"goal-info"},ce={class:"goal-category"},me={class:"goal-actions"},pe=["onClick"],ve={class:"completion-info"},_e={class:"info-item"},fe={class:"value"},ye={class:"info-item"},be={class:"value"},he={key:5,class:"empty-state"},Ce={__name:"Goals",setup(Ae){const{currencies:F,fetchCurrencies:R}=et(),{categories:U,fetchCategories:$}=st(),{activeGoals:b,completedGoals:D,loading:h,error:x,fetchGoals:I,addGoal:P,updateGoal:q,deleteGoal:V,totalTargetAmount:O,totalCurrentAmount:z,totalProgress:T}=tt(),d=M(!1),m=M(null),_=M("active"),n=W({name:"",targetAmount:1e4,currentAmount:0,deadline:new Date(new Date().setMonth(new Date().getMonth()+6)).toISOString().split("T")[0],category:"savings",color:"#4CAF50",priority:"medium",currency:"507f1f77bcf86cd799439013",description:""});X(async()=>{await R(),await $(),await I()});const B={savings:"Poupan√ßa",vehicle:"Ve√≠culo",travel:"Viagem",home:"Casa",education:"Educa√ß√£o",investment:"Investimento",other:"Outro"},G=o=>{if(!o)return"Sem categoria";if(typeof o=="object")return o.name||o.title||o.id||o._id||"Sem categoria";const e=B[o];if(e)return e;const s=(U.value||[]).find(u=>u._id===o||u.id===o);return(s==null?void 0:s.name)||o},L=async()=>{m.value?(await q(m.value._id,n),m.value=null):await P(n),N(),d.value=!1},j=o=>{m.value=o,n.name=o.title||o.name||"",n.targetAmount=o.targetAmount,n.currentAmount=o.currentAmount,n.deadline=o.deadline?new Date(o.deadline).toISOString().split("T")[0]:"",n.category=o.category,n.color=o.color,n.priority=o.priority,n.currency=o.currency,n.description=o.description||"",d.value=!0},H=()=>{m.value=null,N(),d.value=!1},N=()=>{n.name="",n.targetAmount=1e4,n.currentAmount=0,n.deadline=new Date(new Date().setMonth(new Date().getMonth()+6)).toISOString().split("T")[0],n.category="savings",n.color="#4CAF50",n.priority="medium",n.currency="507f1f77bcf86cd799439013",n.description=""},J=o=>{const e=new Date,s=new Date(o),u=Math.ceil((s-e)/(1e3*60*60*24));return Math.max(0,u)},C=o=>typeof(o==null?void 0:o.amountNeeded)=="number"?Math.max(0,o.amountNeeded):Math.max(0,((o==null?void 0:o.targetAmount)||0)-((o==null?void 0:o.currentAmount)||0)),A=o=>typeof(o==null?void 0:o.daysRemaining)=="number"?Math.max(0,o.daysRemaining):J(o==null?void 0:o.deadline),K=o=>{if(typeof(o==null?void 0:o.dailyAmountToSave)=="number")return Math.max(0,o.dailyAmountToSave);const e=C(o),s=A(o);return s<=0?0:e/s},Q=o=>{if(typeof(o==null?void 0:o.monthlyAmountToSave)=="number")return Math.max(0,o.monthlyAmountToSave);const e=C(o),s=A(o);if(s<=0)return 0;const u=Math.max(1,Math.ceil(s/30.4375));return e/u};return(o,e)=>(l(),r("div",nt,[t("div",at,[e[13]||(e[13]=t("h1",null,"Metas Financeiras",-1)),t("button",{onClick:e[0]||(e[0]=s=>d.value=!d.value),class:"btn btn-primary"},a(d.value?"Cancelar":"+ Nova Meta"),1)]),t("div",it,[t("div",rt,[e[14]||(e[14]=t("h3",null,"Meta Total",-1)),t("p",lt,a(i(v)(i(O))),1)]),t("div",dt,[e[15]||(e[15]=t("h3",null,"Total Guardado",-1)),t("p",ut,a(i(v)(i(z))),1)]),t("div",ct,[e[16]||(e[16]=t("h3",null,"Progresso Geral",-1)),t("div",mt,[t("p",pt,a(Math.round(i(T)*100))+"%",1),t("div",vt,[t("div",{class:"progress-fill",style:y({width:`${i(T)*100}%`})},null,4)])])]),t("div",_t,[e[17]||(e[17]=t("h3",null,"Metas Ativas",-1)),t("p",ft,a(i(b).length),1)])]),d.value?(l(),r("div",yt,[t("h3",null,a(m.value?"Editar Meta":"Criar Nova Meta"),1),t("form",{onSubmit:Z(L,["prevent"])},[t("div",bt,[t("div",ht,[e[18]||(e[18]=t("label",null,"Nome da Meta",-1)),c(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>n.name=s),type:"text",required:"",class:"form-control",placeholder:"Ex.: Reserva de Emerg√™ncia"},null,512),[[f,n.name]])]),t("div",Ct,[e[20]||(e[20]=t("label",null,"Categoria",-1)),c(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>n.category=s),class:"form-control",required:""},[...e[19]||(e[19]=[Y('<option value="savings" data-v-52ce23d8>Poupan√ßa</option><option value="vehicle" data-v-52ce23d8>Ve√≠culo</option><option value="travel" data-v-52ce23d8>Viagem</option><option value="home" data-v-52ce23d8>Casa</option><option value="education" data-v-52ce23d8>Educa√ß√£o</option><option value="investment" data-v-52ce23d8>Investimento</option><option value="other" data-v-52ce23d8>Outro</option>',7)])],512),[[w,n.category]])])]),t("div",At,[t("div",Mt,[e[21]||(e[21]=t("label",null,"Valor da Meta",-1)),c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>n.targetAmount=s),type:"number",step:"0.01",required:"",class:"form-control",placeholder:"10000"},null,512),[[f,n.targetAmount]])]),t("div",wt,[e[22]||(e[22]=t("label",null,"Valor Atual",-1)),c(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>n.currentAmount=s),type:"number",step:"0.01",required:"",class:"form-control",placeholder:"0"},null,512),[[f,n.currentAmount]])])]),t("div",kt,[t("div",gt,[e[23]||(e[23]=t("label",null,"Prazo",-1)),c(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>n.deadline=s),type:"date",required:"",class:"form-control"},null,512),[[f,n.deadline]])]),t("div",St,[e[25]||(e[25]=t("label",null,"Prioridade",-1)),c(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>n.priority=s),class:"form-control",required:""},[...e[24]||(e[24]=[t("option",{value:"high"},"Alta",-1),t("option",{value:"medium"},"M√©dia",-1),t("option",{value:"low"},"Baixa",-1)])],512),[[w,n.priority]])])]),t("div",Dt,[t("div",xt,[e[26]||(e[26]=t("label",null,"Moeda",-1)),c(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>n.currency=s),class:"form-control",required:""},[(l(!0),r(k,null,g(i(F),s=>(l(),r("option",{key:s._id,value:s._id},a(s.name)+" ("+a(s.symbol)+") ",9,Vt))),128))],512),[[w,n.currency]])])]),t("div",Tt,[e[27]||(e[27]=t("label",null,"Cor da Meta",-1)),t("div",Gt,[c(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>n.color=s),type:"color",class:"color-input"},null,512),[[f,n.color]]),t("span",{class:"color-preview",style:y({backgroundColor:n.color})},null,4),t("span",null,a(n.color),1)])]),t("div",Nt,[e[28]||(e[28]=t("label",null,"Descri√ß√£o (Opcional)",-1)),c(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=s=>n.description=s),class:"form-control",rows:"3",placeholder:"Adicione observa√ß√µes sobre sua meta..."},null,512),[[f,n.description]])]),t("div",Et,[t("button",{type:"submit",disabled:i(h),class:"btn btn-primary"},a(i(h)?"Salvando...":m.value?"Atualizar Meta":"Criar Meta"),9,Ft),m.value?(l(),r("button",{key:0,onClick:H,type:"button",class:"btn btn-secondary"}," Cancelar ")):p("",!0)])],32)])):p("",!0),i(h)&&!d.value?(l(),r("div",Rt,"Carregando metas...")):p("",!0),i(x)?(l(),r("div",Ut,a(i(x)),1)):p("",!0),t("div",$t,[t("button",{onClick:e[10]||(e[10]=s=>_.value="active"),class:S(["tab-btn",{active:_.value==="active"}])}," Metas Ativas ("+a(i(b).length)+") ",3),t("button",{onClick:e[11]||(e[11]=s=>_.value="completed"),class:S(["tab-btn",{active:_.value==="completed"}])}," Metas Conclu√≠das ("+a(i(D).length)+") ",3)]),_.value==="active"?(l(),r("div",It,[(l(!0),r(k,null,g(i(b),s=>(l(),r("div",{key:s._id,class:"goal-item card"},[t("div",Pt,[t("div",{class:"goal-color",style:y({backgroundColor:s.color})},null,4),t("div",qt,[t("h3",null,a(s.title||s.name),1),t("span",Ot,a(G(s.category)),1),t("span",{class:S(["goal-priority",s.priority])},a(s.priority),3)]),t("div",zt,[t("button",{onClick:u=>j(s),class:"btn-icon",title:"Editar"}," ‚úèÔ∏è ",8,Bt),t("button",{onClick:u=>i(V)(s._id),class:"btn-icon",title:"Excluir"}," üóëÔ∏è ",8,Lt)])]),t("div",jt,[t("div",Ht,[t("span",Jt,a(i(v)(s.currentAmount))+" de "+a(i(v)(s.targetAmount)),1),t("span",Kt,a(Math.round(s.currentAmount/s.targetAmount*100))+"%",1)]),t("div",Qt,[t("div",{class:"progress-fill",style:y({width:`${s.currentAmount/s.targetAmount*100}%`,backgroundColor:s.color})},null,4)])]),t("div",Wt,[t("div",Xt,[e[29]||(e[29]=t("span",{class:"label"},"Prazo:",-1)),t("span",Yt,a(i(E)(s.deadline)),1)]),t("div",Zt,[e[30]||(e[30]=t("span",{class:"label"},"Dias Restantes:",-1)),t("span",te,a(A(s))+" dias",1)]),t("div",ee,[e[31]||(e[31]=t("span",{class:"label"},"Faltam:",-1)),t("span",se,a(i(v)(C(s))),1)]),t("div",oe,[e[32]||(e[32]=t("span",{class:"label"},"Necess√°rio por Dia:",-1)),t("span",ne,a(i(v)(K(s)))+"/dia",1)]),t("div",ae,[e[33]||(e[33]=t("span",{class:"label"},"Necess√°rio por M√™s:",-1)),t("span",ie,a(i(v)(Q(s)))+"/m√™s",1)])]),s.description?(l(),r("div",re,a(s.description),1)):p("",!0)]))),128))])):p("",!0),_.value==="completed"?(l(),r("div",le,[(l(!0),r(k,null,g(i(D),s=>(l(),r("div",{key:s._id,class:"completed-goal card"},[e[36]||(e[36]=t("div",{class:"completion-badge"},"üéâ Conclu√≠da!",-1)),t("div",de,[t("div",{class:"goal-color",style:y({backgroundColor:s.color})},null,4),t("div",ue,[t("h3",null,a(s.title||s.name),1),t("span",ce,a(G(s.category)),1)]),t("div",me,[t("button",{onClick:u=>i(V)(s._id),class:"btn-icon",title:"Excluir"}," üóëÔ∏è ",8,pe)])]),t("div",ve,[t("div",_e,[e[34]||(e[34]=t("span",{class:"label"},"Conclu√≠da em:",-1)),t("span",fe,a(i(E)(new Date().toISOString())),1)]),t("div",ye,[e[35]||(e[35]=t("span",{class:"label"},"Total Guardado:",-1)),t("span",be,a(i(v)(s.targetAmount)),1)])])]))),128))])):p("",!0),i(b).length===0&&!i(h)?(l(),r("div",he,[e[37]||(e[37]=t("div",{class:"empty-icon"},"üéØ",-1)),e[38]||(e[38]=t("h3",null,"Nenhuma Meta Financeira Ainda",-1)),e[39]||(e[39]=t("p",null,"Comece criando sua primeira meta financeira",-1)),t("button",{onClick:e[12]||(e[12]=s=>d.value=!0),class:"btn btn-primary"}," Criar Primeira Meta ")])):p("",!0)]))}},Te=ot(Ce,[["__scopeId","data-v-52ce23d8"]]);export{Te as default};
