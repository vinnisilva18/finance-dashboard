import{d as m,r as y,c as u}from"./vendor-kE9Pwckw.js";import{a as g}from"./index-CZQAM9fZ.js";const h=m("category",()=>{const t=y([]);return{categories:t,setCategories:s=>{t.value=s},addCategory:s=>{t.value.push(s)},deleteCategory:s=>{t.value=t.value.filter(l=>l.id!==s)},updateCategory:(s,l)=>{const e=t.value.findIndex(d=>d.id===s);e!==-1&&(t.value[e]={...t.value[e],...l})},getCategoryById:s=>t.value.find(l=>l.id===s),getCategoriesByType:s=>t.value.filter(l=>l.type===s)}}),I=()=>{const t=h(),n=y(!1),i=y(null),p=async()=>{var e,d;n.value=!0,i.value=null;try{const r=await g.get("/categories");let a=[];Array.isArray(r.data)?a=r.data:r.data&&Array.isArray(r.data.data)&&(a=r.data.data);const o=a.map(c=>({...c,id:c._id||c.id,_id:c._id||c.id}));t.setCategories(o)}catch(r){i.value=((d=(e=r.response)==null?void 0:e.data)==null?void 0:d.message)||"Failed to fetch categories",console.error("Erro ao buscar categorias:",r)}finally{n.value=!1}},f=async e=>{var d,r;n.value=!0,i.value=null;try{const a=await g.post("/categories",e),o={...a.data,id:a.data._id||a.data.id,_id:a.data._id||a.data.id};return t.addCategory(o),o}catch(a){throw i.value=((r=(d=a.response)==null?void 0:d.data)==null?void 0:r.message)||"Failed to add category",a}finally{n.value=!1}},v=async(e,d)=>{var r,a;if(!e||e==="undefined"){const o="ID de categoria inválido para atualização";throw console.error(o,e),new Error(o)}n.value=!0,i.value=null;try{const o=await g.put(`/categories/${e}`,d),c={...o.data,id:o.data._id||o.data.id,_id:o.data._id||o.data.id};return t.updateCategory(e,c),c}catch(o){throw i.value=((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to update category",o}finally{n.value=!1}},C=async e=>{var d,r;if(!e||e==="undefined"){const a="Invalid category ID";throw console.error(a,e),new Error(a)}n.value=!0,i.value=null;try{await g.delete(`/categories/${e}`),t.deleteCategory(e)}catch(a){throw i.value=((r=(d=a.response)==null?void 0:d.data)==null?void 0:r.message)||"Failed to delete category",a}finally{n.value=!1}},s=u(()=>t.categories.filter(e=>e.type==="expense")),l=u(()=>t.categories.filter(e=>e.type==="income"));return{categories:u(()=>t.categories),expenseCategories:s,incomeCategories:l,loading:n,error:i,fetchCategories:p,addCategory:f,updateCategory:v,deleteCategory:C}};export{h as a,I as u};
