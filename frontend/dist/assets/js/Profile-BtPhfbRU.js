import{d as A,r as m,c as k,C as x,o as N,a as R,e,h as M,t as c,l as V,f as S,E as P,H as E,p as j}from"./vendor-kE9Pwckw.js";import{a as b,_ as B,u as G}from"./index-CZQAM9fZ.js";import{l as f}from"./localStorageService-Bm_UUCrj.js";import"./utils-B9ygI19o.js";const O=A("user",()=>{const g=m(null),p=m(localStorage.getItem("token")),n=m(!1),s=m(null),w=k(()=>!!p.value);async function C(d){var o,l;n.value=!0,s.value=null;try{const t=await b.post("/auth/login",d);return p.value=t.data.token,g.value=t.data.user,localStorage.setItem("token",p.value),t.data}catch(t){throw s.value=((l=(o=t.response)==null?void 0:o.data)==null?void 0:l.message)||"Erro ao fazer login",t}finally{n.value=!1}}async function h(d){var o,l;n.value=!0,s.value=null;try{return(await b.post("/auth/register",d)).data}catch(t){throw s.value=((l=(o=t.response)==null?void 0:o.data)==null?void 0:l.message)||"Erro ao registrar",t}finally{n.value=!1}}async function y(){try{await b.post("/auth/logout")}finally{p.value=null,g.value=null,localStorage.removeItem("token")}}async function i(){try{const d=await b.get("/auth/profile");g.value=d.data}catch{y()}}async function u(d){var o,l;n.value=!0,s.value=null;try{const t=await b.put("/auth/profile",d);return g.value=t.data,t.data}catch(t){throw s.value=((l=(o=t.response)==null?void 0:o.data)==null?void 0:l.message)||"Erro ao atualizar perfil",t}finally{n.value=!1}}return{user:g,token:p,loading:n,error:s,isAuthenticated:w,login:C,register:h,logout:y,fetchProfile:i,updateProfile:u}}),q={class:"profile"},J={class:"profile-grid"},F={class:"profile-card card"},H={class:"profile-header"},L={class:"profile-info"},$={class:"member-since"},K={class:"profile-stats"},Q={class:"stat-item"},W={class:"stat-value"},X={class:"stat-item"},Y={class:"stat-value"},Z={class:"stat-item"},ee={class:"stat-value"},ae={class:"stat-item"},te={class:"stat-value"},se={class:"settings-card card"},oe={class:"form-section"},le={class:"form-row"},re={class:"form-group"},ne={class:"form-group"},ie={class:"form-section"},ue={class:"preferences-grid"},de={class:"preference-item"},ce={class:"checkbox-label"},pe={class:"preference-item"},me={class:"checkbox-label"},ve={class:"form-actions"},fe=["disabled"],ge={class:"data-management-card card"},ye={__name:"Profile",setup(g){const p=G(),n=O(),s=k(()=>p.user||n.user),w=k(()=>{var r;return(r=s.value)!=null&&r.name?s.value.name.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2):"U"}),C=k(()=>new Date().toLocaleDateString("pt-BR",{year:"numeric",month:"long"})),h=m("#4CAF50"),y=m(null),i=m({transactions:0,categories:0,activeGoals:0,creditCards:0}),u=x({name:"",email:""}),d=()=>{s.value&&(u.name=s.value.name||"",u.email=s.value.email||"")},o=x({notifications:!0,weeklyReports:!0}),l=m(!1);N(()=>{const r=localStorage.getItem("userPreferences");r&&Object.assign(o,JSON.parse(r));const a=localStorage.getItem("userColor");a&&(h.value=a),d(),i.value.transactions=(f.getData("transactions")||[]).length,i.value.categories=(f.getData("categories")||[]).length,i.value.activeGoals=(f.getData("goals")||[]).length,i.value.creditCards=(f.getData("cards")||[]).length});const t=async()=>{l.value=!0;try{s.value&&p.updateUser({name:u.name,email:u.email}),n.setPreferences(o),localStorage.setItem("userPreferences",JSON.stringify(o)),await new Promise(r=>setTimeout(r,1e3)),alert("Perfil atualizado com sucesso!")}catch(r){alert("Erro ao atualizar o perfil: "+r.message)}finally{l.value=!1}},I=()=>{f.exportData()},U=()=>{y.value.click()},T=async r=>{const a=r.target.files[0];if(a)try{await f.importData(a),alert("Dados importados com sucesso! A pÃ¡gina serÃ¡ recarregada."),window.location.reload()}catch(_){alert(`Erro ao importar dados: ${_.message}`)}finally{y.value.value=""}},z=()=>{confirm("Tem certeza que deseja apagar todos os dados? Esta aÃ§Ã£o nÃ£o pode ser desfeita.")&&(f.resetData(),alert("Todos os dados foram apagados. A pÃ¡gina serÃ¡ recarregada."),window.location.reload())};return(r,a)=>{var _,D;return j(),R("div",q,[a[17]||(a[17]=e("h1",null,"ConfiguraÃ§Ãµes de Perfil",-1)),e("div",J,[e("div",F,[e("div",H,[e("div",{class:"avatar",style:M({backgroundColor:h.value})},c(w.value),5),e("div",L,[e("h2",null,c(((_=s.value)==null?void 0:_.name)||"Nome do UsuÃ¡rio"),1),e("p",null,c(((D=s.value)==null?void 0:D.email)||"user@example.com"),1),e("span",$,"Membro desde "+c(C.value),1)])]),e("div",K,[e("div",Q,[a[4]||(a[4]=e("span",{class:"stat-label"},"Total de TransaÃ§Ãµes",-1)),e("span",W,c(i.value.transactions),1)]),e("div",X,[a[5]||(a[5]=e("span",{class:"stat-label"},"Categorias",-1)),e("span",Y,c(i.value.categories),1)]),e("div",Z,[a[6]||(a[6]=e("span",{class:"stat-label"},"Metas Ativas",-1)),e("span",ee,c(i.value.activeGoals),1)]),e("div",ae,[a[7]||(a[7]=e("span",{class:"stat-label"},"CartÃµes de CrÃ©dito",-1)),e("span",te,c(i.value.creditCards),1)])])]),e("div",se,[a[14]||(a[14]=e("h3",null,"ConfiguraÃ§Ãµes da Conta",-1)),e("form",{onSubmit:V(t,["prevent"])},[e("div",oe,[a[10]||(a[10]=e("h4",null,"InformaÃ§Ãµes Pessoais",-1)),e("div",le,[e("div",re,[a[8]||(a[8]=e("label",null,"Nome Completo",-1)),S(e("input",{"onUpdate:modelValue":a[0]||(a[0]=v=>u.name=v),type:"text",class:"form-control"},null,512),[[P,u.name]])]),e("div",ne,[a[9]||(a[9]=e("label",null,"EndereÃ§o de Email",-1)),S(e("input",{"onUpdate:modelValue":a[1]||(a[1]=v=>u.email=v),type:"email",class:"form-control"},null,512),[[P,u.email]])])])]),e("div",ie,[a[13]||(a[13]=e("h4",null,"PreferÃªncias",-1)),e("div",ue,[e("div",de,[e("label",ce,[S(e("input",{"onUpdate:modelValue":a[2]||(a[2]=v=>o.notifications=v),type:"checkbox"},null,512),[[E,o.notifications]]),a[11]||(a[11]=e("span",null,"NotificaÃ§Ãµes por Email",-1))])]),e("div",pe,[e("label",me,[S(e("input",{"onUpdate:modelValue":a[3]||(a[3]=v=>o.weeklyReports=v),type:"checkbox"},null,512),[[E,o.weeklyReports]]),a[12]||(a[12]=e("span",null,"RelatÃ³rios Semanais",-1))])])])]),e("div",ve,[e("button",{type:"submit",disabled:l.value,class:"btn btn-primary"},c(l.value?"Salvando...":"Salvar AlteraÃ§Ãµes"),9,fe)])],32)]),e("div",ge,[a[15]||(a[15]=e("h3",null,"Gerenciamento de Dados",-1)),a[16]||(a[16]=e("p",null,"Exporte seus dados para um arquivo JSON, importe um arquivo de backup ou restaure o aplicativo para o estado inicial.",-1)),e("input",{type:"file",ref_key:"fileInput",ref:y,onChange:T,style:{display:"none"},accept:"application/json"},null,544),e("div",{class:"data-actions"},[e("button",{onClick:I,class:"btn btn-secondary"}," ğŸ“¤ Exportar Todos os Dados "),e("button",{onClick:U,class:"btn btn-primary"}," ğŸ“¥ Importar Dados "),e("button",{onClick:z,class:"btn btn-danger"}," ğŸ—‘ï¸ Restaurar Todos os Dados ")])])])])}}},ke=B(ye,[["__scopeId","data-v-28cb3513"]]);export{ke as default};
