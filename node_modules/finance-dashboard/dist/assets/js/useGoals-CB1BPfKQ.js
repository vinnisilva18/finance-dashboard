import{d as w,r as G,c as g}from"./vendor-kE9Pwckw.js";import{l as c}from"./localStorageService-Bm_UUCrj.js";const x=w("goal",()=>{const e=G([]);return{goals:e,setGoals:l=>{e.value=l},addGoal:l=>{e.value.push(l)},deleteGoal:l=>{e.value=e.value.filter(u=>u.id!==l)},updateGoal:(l,u)=>{const s=e.value.findIndex(v=>v.id===l);s!==-1&&(e.value[s]={...e.value[s],...u})},addContribution:(l,u)=>{const s=e.value.find(v=>v.id===l);s&&(s.currentAmount+=u,s.currentAmount>s.targetAmount&&(s.currentAmount=s.targetAmount))},getGoalById:l=>e.value.find(u=>u.id===l),getGoalsByPriority:l=>e.value.filter(u=>u.priority===l)}}),d="goals",C=()=>{const e=x(),r=G(!1),i=G(null),m=async()=>{r.value=!0,i.value=null;try{const t=c.getData(d)||[];e.setGoals(t)}catch{i.value="Failed to fetch goals"}finally{r.value=!1}},y=async t=>{r.value=!0;try{const a={...t,id:Date.now(),currentAmount:0},n=[...c.getData(d)||[],a];c.saveData(d,n),e.addGoal(a)}catch(a){throw i.value="Failed to add goal",a}finally{r.value=!1}},A=async(t,a)=>{r.value=!0;try{let o=c.getData(d)||[];const n=o.findIndex(f=>f.id===t);n!==-1&&(o[n]={...o[n],...a},c.saveData(d,o),e.updateGoal(t,a))}catch(o){throw i.value="Failed to update goal",o}finally{r.value=!1}},p=async t=>{r.value=!0;try{const o=(c.getData(d)||[]).filter(n=>n.id!==t);c.saveData(d,o),e.deleteGoal(t)}catch(a){throw i.value="Failed to delete goal",a}finally{r.value=!1}},h=async(t,a)=>{r.value=!0;try{let o=c.getData(d)||[];const n=o.findIndex(f=>f.id===t);n!==-1&&(o[n].currentAmount+=a,o[n].currentAmount>o[n].targetAmount&&(o[n].currentAmount=o[n].targetAmount),c.saveData(d,o),e.addContribution(t,a))}catch(o){throw i.value="Failed to add contribution",o}finally{r.value=!1}},l=g(()=>e.goals.reduce((t,a)=>t+a.targetAmount,0)),u=g(()=>e.goals.reduce((t,a)=>t+a.currentAmount,0)),s=g(()=>l.value>0?u.value/l.value:0),v=g(()=>e.goals.filter(t=>{const a=new Date(t.deadline);return t.currentAmount<t.targetAmount&&a>new Date})),D=g(()=>e.goals.filter(t=>t.currentAmount>=t.targetAmount));return{goals:g(()=>e.goals),activeGoals:v,completedGoals:D,loading:r,error:i,fetchGoals:m,addGoal:y,updateGoal:A,deleteGoal:p,addContribution:h,totalTargetAmount:l,totalCurrentAmount:u,totalProgress:s}};export{C as u};
