import{r as h,c as $,o as q,a as l,e,b as g,f as B,I as z,E,z as a,t as n,n as N,h as C,F as M,A as F,m as i}from"./vendor-CeDlel3h.js";import{l as I}from"./localStorageService-Bm_UUCrj.js";import{a as L,f as v}from"./formatters-B8MMj10x.js";import{_ as O}from"./index-Dv0HwUHl.js";const U=()=>{const k=h(!1),p=h(null),c=h({...{totalIncome:0,totalExpenses:0,netSavings:0,savingsRate:0,incomeChange:0,expenseChange:0,savingsChange:0,budgetStatus:"under",incomeSources:[],expenseCategories:[],budgetComparison:[],topTransactions:[],goals:[],goalsProgress:{completed:0,total:0,percentage:0}}});return{loading:k,error:p,reportData:c,generateReport:S=>{k.value=!0,p.value=null;try{const r=I.getData("transactions")||[],_=I.getData("categories")||[],m=I.getData("goals")||[],y=r,b=y.filter(o=>o.type==="income").reduce((o,d)=>o+d.amount,0),f=y.filter(o=>o.type==="expense").reduce((o,d)=>o+d.amount,0),w=b+f,P=b>0?w/b:0,T=_.filter(o=>o.type==="expense").map(o=>{const d=y.filter(R=>R.type==="expense"&&R.category===o.name).reduce((R,V)=>R+V.amount,0);return{name:o.name,amount:Math.abs(d),percentage:f!==0?(Math.abs(d)/Math.abs(f)*100).toFixed(1):0,color:o.color}}).filter(o=>o.amount>0).sort((o,d)=>d.amount-o.amount),A=[...y].sort((o,d)=>Math.abs(d.amount)-Math.abs(o.amount)).slice(0,5).map(o=>{const d=_.find(R=>R.name===o.category);return{...o,categoryColor:d?d.color:"#808080"}}),u=m.filter(o=>o.currentAmount>=o.targetAmount).length,t={completed:u,total:m.length,percentage:m.length>0?u/m.length*100:0},s=m.map(o=>({id:o.id,name:o.name,current:o.currentAmount,target:o.targetAmount,progress:o.targetAmount>0?(o.currentAmount/o.targetAmount*100).toFixed(0):0,deadline:o.deadline,color:o.color}));c.value={totalIncome:b,totalExpenses:Math.abs(f),netSavings:w,savingsRate:P,incomeChange:0,expenseChange:0,savingsChange:0,budgetStatus:"under",incomeSources:[],expenseCategories:T,budgetComparison:[],topTransactions:A,goals:s,goalsProgress:t}}catch(r){p.value="Failed to generate report",console.error(r)}finally{k.value=!1}}}},Y={class:"reports"},G={class:"header"},j={class:"header-actions"},H={key:0,class:"custom-range card"},J={class:"range-selector"},K={class:"date-input"},Q={class:"date-input"},W={key:1,class:"report-summary"},X={class:"summary-card"},Z={class:"amount positive"},ee={class:"summary-card"},te={class:"amount negative"},se={class:"summary-card"},oe={class:"summary-card"},ae={class:"amount"},ne={key:2,class:"loading-state"},re={key:3,class:"report-sections"},le={class:"section-card card"},ie={class:"section-header"},de={class:"section-period"},ce={class:"income-breakdown"},ue={key:0,class:"empty-data"},pe={class:"source-info"},me={class:"source-name"},ge={class:"source-amount"},ve={class:"source-bar"},he={class:"source-percentage"},_e={class:"section-card card"},ye={class:"section-header"},be={class:"section-period"},fe={class:"expense-categories"},Re={key:0,class:"empty-data"},Ce={class:"category-info"},ke={class:"category-name"},xe={class:"category-stats"},De={class:"category-amount"},Se={class:"category-percentage"},we={class:"category-progress"},Me={class:"progress-bar"},Fe={class:"section-card card"},Pe={class:"section-header"},Te={class:"transaction-count"},Ae={class:"transactions-list"},Be={key:0,class:"empty-data"},Ie={key:1},Le={class:"section-card card"},$e={class:"section-header"},Ee={class:"goals-summary"},Ne={class:"goals-progress"},Ve={key:0,class:"empty-data"},qe={class:"goal-header"},ze={class:"goal-name"},Oe={class:"goal-percentage"},Ue={class:"progress-bar"},Ye={class:"goal-details"},Ge={class:"goal-deadline"},je={key:4,class:"error-state"},He={__name:"Reports",setup(k){const p=h("monthly"),x=h(!1);h("income");const c=h({start:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),{loading:D,error:S,reportData:r,generateReport:_}=U(),m=$(()=>{const u=new Date;switch(p.value){case"monthly":return u.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});case"quarterly":return`T${Math.floor(u.getMonth()/3)+1} ${u.getFullYear()}`;case"yearly":return u.getFullYear().toString();case"custom":return`${L(c.value.start)} - ${L(c.value.end)}`;default:return"Per√≠odo Atual"}}),y=$(()=>{const u=r.value.savingsRate||0;return{background:`conic-gradient(#4CAF50 0% ${u*100}%, #f0f0f0 ${u*100}% 100%)`}});q(()=>{_(p.value)});const b=()=>{p.value==="custom"?x.value=!0:(x.value=!1,_(p.value))},f=()=>{_({start:c.value.start,end:c.value.end})},w=()=>{alert("Funcionalidade de exportar em desenvolvimento.")},P=()=>{window.print()},T=()=>{alert("Funcionalidade de salvar em desenvolvimento.")},A=()=>{navigator.share?navigator.share({title:`Relat√≥rio Financeiro - ${m.value}`,text:`Confira meu relat√≥rio financeiro para ${m.value}`,url:window.location.href}):alert("API de compartilhamento n√£o suportada no seu navegador.")};return(u,t)=>(i(),l("div",Y,[e("div",G,[t[4]||(t[4]=e("h1",null,"Relat√≥rios Financeiros",-1)),e("div",j,[B(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),onChange:b,class:"period-select"},[...t[3]||(t[3]=[e("option",{value:"monthly"},"Relat√≥rio Mensal",-1),e("option",{value:"quarterly"},"Relat√≥rio Trimestral",-1),e("option",{value:"yearly"},"Relat√≥rio Anual",-1),e("option",{value:"custom"},"Per√≠odo Personalizado",-1)])],544),[[z,p.value]]),e("button",{onClick:w,class:"btn btn-primary"}," üìä Exportar Relat√≥rio ")])]),x.value?(i(),l("div",H,[t[7]||(t[7]=e("h3",null,"Intervalo de Datas Personalizado",-1)),e("div",J,[e("div",K,[t[5]||(t[5]=e("label",null,"De",-1)),B(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>c.value.start=s),type:"date",class:"form-control"},null,512),[[E,c.value.start]])]),e("div",Q,[t[6]||(t[6]=e("label",null,"Para",-1)),B(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>c.value.end=s),type:"date",class:"form-control"},null,512),[[E,c.value.end]])]),e("button",{onClick:f,class:"btn btn-primary"}," Aplicar ")])])):g("",!0),a(D)?g("",!0):(i(),l("div",W,[e("div",X,[t[8]||(t[8]=e("h3",null,"Receita Total",-1)),e("p",Z,n(a(v)(a(r).totalIncome,"BRL")),1)]),e("div",ee,[t[9]||(t[9]=e("h3",null,"Despesa Total",-1)),e("p",te,n(a(v)(a(r).totalExpenses,"BRL")),1)]),e("div",se,[t[10]||(t[10]=e("h3",null,"Economia L√≠quida",-1)),e("p",{class:N(["amount",a(r).netSavings>=0?"positive":"negative"])},n(a(v)(a(r).netSavings,"BRL")),3)]),e("div",oe,[t[11]||(t[11]=e("h3",null,"Taxa de Poupan√ßa",-1)),e("p",ae,n((a(r).savingsRate*100).toFixed(1))+"%",1),e("div",{class:"progress-circle",style:C(y.value)},[e("span",null,n(Math.round(a(r).savingsRate*100))+"%",1)],4)])])),a(D)?(i(),l("div",ne,[...t[12]||(t[12]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Gerando relat√≥rio...",-1)])])):g("",!0),!a(D)&&!a(S)?(i(),l("div",re,[e("div",le,[e("div",ie,[t[13]||(t[13]=e("h3",null,"Detalhamento de Receitas",-1)),e("div",de,n(m.value),1)]),e("div",ce,[a(r).incomeSources.length===0?(i(),l("div",ue," Nenhuma receita encontrada para este per√≠odo. ")):g("",!0),(i(!0),l(M,null,F(a(r).incomeSources,s=>(i(),l("div",{key:s.name,class:"source-item"},[e("div",pe,[e("div",me,n(s.name),1),e("div",ge,n(a(v)(s.amount,"BRL")),1)]),e("div",ve,[e("div",{class:"bar-fill",style:C({width:`${s.amount/a(r).totalIncome*100}%`,backgroundColor:s.color})},null,4)]),e("div",he,n((s.amount/a(r).totalIncome*100).toFixed(1))+"% ",1)]))),128))])]),e("div",_e,[e("div",ye,[t[14]||(t[14]=e("h3",null,"Categorias de Despesas",-1)),e("div",be,n(m.value),1)]),e("div",fe,[a(r).expenseCategories.length===0?(i(),l("div",Re," Nenhuma despesa encontrada para este per√≠odo. ")):g("",!0),(i(!0),l(M,null,F(a(r).expenseCategories,s=>(i(),l("div",{key:s.name,class:"category-item"},[e("div",{class:"category-color",style:C({backgroundColor:s.color})},null,4),e("div",Ce,[e("div",ke,n(s.name),1),e("div",xe,[e("span",De,n(a(v)(s.amount,"BRL")),1),e("span",Se,n(s.percentage)+"%",1)])]),e("div",we,[e("div",Me,[e("div",{class:"progress-fill",style:C({width:`${s.percentage}%`,backgroundColor:s.color})},null,4)])])]))),128))])]),e("div",Fe,[e("div",Pe,[t[15]||(t[15]=e("h3",null,"Maiores Transa√ß√µes",-1)),e("div",Te,n(a(r).topTransactions.length)+" maiores",1)]),e("div",Ae,[a(r).topTransactions.length===0?(i(),l("div",Be," Nenhuma transa√ß√£o encontrada para este per√≠odo. ")):(i(),l("table",Ie,[t[16]||(t[16]=e("thead",null,[e("tr",null,[e("th",null,"Data"),e("th",null,"Descri√ß√£o"),e("th",null,"Categoria"),e("th",null,"Valor")])],-1)),e("tbody",null,[(i(!0),l(M,null,F(a(r).topTransactions,s=>(i(),l("tr",{key:s.id},[e("td",null,n(a(L)(s.date)),1),e("td",null,n(s.description),1),e("td",null,[e("span",{class:"category-tag",style:C({backgroundColor:s.categoryColor})},n(s.category),5)]),e("td",{class:N(s.amount>=0?"positive":"negative")},n(a(v)(s.amount,"BRL")),3)]))),128))])]))])]),e("div",Le,[e("div",$e,[t[17]||(t[17]=e("h3",null,"Progresso das Metas",-1)),e("div",Ee,n(a(r).goalsProgress.completed)+"/"+n(a(r).goalsProgress.total)+" completas ",1)]),e("div",Ne,[a(r).goals.length===0?(i(),l("div",Ve," Nenhuma meta encontrada. ")):g("",!0),(i(!0),l(M,null,F(a(r).goals,s=>(i(),l("div",{key:s.id,class:"goal-item"},[e("div",qe,[e("span",ze,n(s.name),1),e("span",Oe,n(s.progress)+"%",1)]),e("div",Ue,[e("div",{class:"progress-fill",style:C({width:`${s.progress}%`,backgroundColor:s.color})},null,4)]),e("div",Ye,[e("span",null,n(a(v)(s.current,"BRL"))+" / "+n(a(v)(s.target,"BRL")),1),e("span",Ge,n(s.deadline),1)])]))),128))])])])):g("",!0),a(S)?(i(),l("div",je,[t[18]||(t[18]=e("h3",null,"Ocorreu um erro ao gerar o relat√≥rio.",-1)),e("p",null,n(a(S)),1)])):g("",!0),e("div",{class:"report-actions"},[e("button",{onClick:P,class:"btn btn-primary"}," üñ®Ô∏è Imprimir Relat√≥rio "),e("button",{onClick:T,class:"btn btn-secondary"}," üíæ Salvar Relat√≥rio "),e("button",{onClick:A,class:"btn"}," üì§ Compartilhar ")])]))}},Xe=O(He,[["__scopeId","data-v-8b0e68d9"]]);export{Xe as default};
