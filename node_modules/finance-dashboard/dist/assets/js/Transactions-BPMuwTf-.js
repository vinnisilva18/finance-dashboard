import{d as _,r as x,c as k,o as A,a as T,e as t,b as h,t as c,f as D,E as w,I as V,z as p,D as F,F as I,A as E,m as g,n as C}from"./vendor-LfCTP-hD.js";import{l as m}from"./localStorageService-Bm_UUCrj.js";import{a as M,f as q}from"./formatters-B8MMj10x.js";import{_ as N}from"./index-t8Iq_7gf.js";const R=_("transaction",()=>{const o=x([]);return{transactions:o,setTransactions:i=>{o.value=i},addTransaction:i=>{o.value.unshift(i)},deleteTransaction:i=>{o.value=o.value.filter(v=>v.id!==i)},updateTransaction:(i,v)=>{const s=o.value.findIndex(a=>a.id===i);s!==-1&&(o.value[s]={...o.value[s],...v})}}}),f="transactions",U=()=>{const o=R(),l=x(!1),r=x(null),b=async(s={})=>{l.value=!0,r.value=null;try{const a=m.getData(f)||[];o.setTransactions(a)}catch{r.value="Failed to fetch transactions"}finally{l.value=!1}},S=async s=>{l.value=!0;try{const a={...s,id:Date.now()},d=[...m.getData(f)||[],a];m.saveData(f,d),o.addTransaction(a)}catch(a){throw r.value="Failed to add transaction",a}finally{l.value=!1}},i=async(s,a)=>{l.value=!0;try{let u=m.getData(f)||[];const d=u.findIndex(y=>y.id===s);d!==-1&&(u[d]={...u[d],...a},m.saveData(f,u),o.updateTransaction(s,a))}catch(u){throw r.value="Failed to update transaction",u}finally{l.value=!1}},v=async s=>{l.value=!0;try{const u=(m.getData(f)||[]).filter(d=>d.id!==s);m.saveData(f,u),o.deleteTransaction(s)}catch(a){throw r.value="Failed to delete transaction",a}finally{l.value=!1}};return{transactions:k(()=>o.transactions),loading:l,error:r,fetchTransactions:b,addTransaction:S,updateTransaction:i,deleteTransaction:v}},B={class:"transactions"},O={class:"controls"},z={key:0,class:"transaction-form card"},L={class:"form-group"},$={class:"form-group"},j={class:"form-group"},G={class:"form-group"},K={class:"form-group"},Y=["disabled"],H={key:1,class:"loading"},J={key:2,class:"error"},P={class:"transactions-list"},Q=["onClick"],W={__name:"Transactions",setup(o){const{transactions:l,loading:r,error:b,fetchTransactions:S,addTransaction:i,deleteTransaction:v}=U(),s=x(!1),a=x({description:"",amount:0,type:"expense",category:"",date:new Date().toISOString().split("T")[0]});A(()=>{S()});const u=async()=>{try{await i({...a.value,amount:a.value.type==="expense"?-Math.abs(a.value.amount):Math.abs(a.value.amount)}),a.value={description:"",amount:0,type:"expense",category:"",date:new Date().toISOString().split("T")[0]},s.value=!1}catch(y){console.error("Error adding transaction:",y)}},d=async y=>{confirm("Tem certeza que deseja excluir esta transação?")&&await v(y)};return(y,e)=>(g(),T("div",B,[e[14]||(e[14]=t("h1",null,"Transações",-1)),t("div",O,[t("button",{onClick:e[0]||(e[0]=n=>s.value=!s.value),class:"btn btn-primary"},c(s.value?"Cancelar":"Adicionar Transação"),1)]),s.value?(g(),T("div",z,[e[12]||(e[12]=t("h3",null,"Adicionar Nova Transação",-1)),t("form",{onSubmit:F(u,["prevent"])},[t("div",L,[e[6]||(e[6]=t("label",null,"Descrição",-1)),D(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>a.value.description=n),type:"text",required:"",class:"form-control"},null,512),[[w,a.value.description]])]),t("div",$,[e[7]||(e[7]=t("label",null,"Valor",-1)),D(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>a.value.amount=n),type:"number",step:"0.01",required:"",class:"form-control"},null,512),[[w,a.value.amount,void 0,{number:!0}]])]),t("div",j,[e[9]||(e[9]=t("label",null,"Tipo",-1)),D(t("select",{"onUpdate:modelValue":e[3]||(e[3]=n=>a.value.type=n),class:"form-control"},[...e[8]||(e[8]=[t("option",{value:"income"},"Receita",-1),t("option",{value:"expense"},"Despesa",-1)])],512),[[V,a.value.type]])]),t("div",G,[e[10]||(e[10]=t("label",null,"Categoria",-1)),D(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>a.value.category=n),type:"text",required:"",class:"form-control"},null,512),[[w,a.value.category]])]),t("div",K,[e[11]||(e[11]=t("label",null,"Data",-1)),D(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>a.value.date=n),type:"date",required:"",class:"form-control"},null,512),[[w,a.value.date]])]),t("button",{type:"submit",disabled:p(r),class:"btn btn-primary"},c(p(r)?"Adicionando...":"Adicionar Transação"),9,Y)],32)])):h("",!0),p(r)?(g(),T("div",H,"Carregando...")):h("",!0),p(b)?(g(),T("div",J,c(p(b)),1)):h("",!0),t("div",P,[t("table",null,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"Data"),t("th",null,"Descrição"),t("th",null,"Categoria"),t("th",null,"Tipo"),t("th",null,"Valor"),t("th",null,"Ações")])],-1)),t("tbody",null,[(g(!0),T(I,null,E(p(l),n=>(g(),T("tr",{key:n.id},[t("td",null,c(p(M)(n.date)),1),t("td",null,c(n.description),1),t("td",null,c(n.category),1),t("td",null,[t("span",{class:C(["type-badge",n.type])},c(n.type==="income"?"Receita":"Despesa"),3)]),t("td",{class:C({negative:n.amount<0,positive:n.amount>0})},c(p(q)(n.amount,"BRL")),3),t("td",null,[t("button",{onClick:X=>d(n.id),class:"btn btn-danger btn-sm"}," Excluir ",8,Q)])]))),128))])])])]))}},nt=N(W,[["__scopeId","data-v-98a93d8c"]]);export{nt as default};
